var cbAcebaseOption={require:["ace/ext/language_tools"],mode:"sql",useWrapMode:!1,newLineMode:"unix",showInvisibles:!0,advanced:{autoScrollEditorIntoView:!0,enableBasicAutocompletion:!0,enableLiveAutocompletion:!0},rendererOptions:{fontSize:"14px",minLines:10,maxLines:100}},cbAceStringify=function(e,n,t,o){n?n:n="";var l=0!=o?JSON.stringify(e,null,2).replace(/\\\\/g,"\\"):JSON.stringify(e,null).replace(/\\\\/g,"\\");return 0!=t&&(l=l.replace(/"/g,"'")),l=n+l+n},cbObj2Array=function(e){return Object.keys(e).map(function(n){return{name:n,body:e[n]}})},esBuckets=[{name:"date_hist",body:{date_histogram:{field:"<columnname>",format:"yyyy-MM-dd HH:mm:ss",interval:"10m",time_zone:"+08:00"}}},{name:"number_range",body:{range:{field:"<columnname>",ranges:[{to:1e4},{from:1e4,to:3e4},{from:3e4}]}}},{name:"number_hist",body:{histogram:{field:"<columnname>",interval:50,min_doc_count:1,missing:0}}}],cbEsQueryCompleter={getCompletions:function(e,n,t,o,l){l(null,esBuckets.map(function(e){return{meta:"es-bucket",caption:e.name,value:'"<columnname>": '+cbAceStringify(e.body,null,!1)}}))}},cbEsSchemaORCompleter={getCompletions:function(e,n,t,o,l){l(null,esBuckets.map(function(e){return{meta:"es-bucket",caption:e.name,value:'"esBucket": '+cbAceStringify(e.body,null,!1)}}))}},esFilter={termFilter:{term:{"<filter_column>":"<value>"}},termsFilter:{terms:{"<filter_column>":["<value1>","<value2>"]}},rangeFilter:{range:{"<filter_column>":{gte:10,lte:20}}},boolFilter:{bool:{must:[{}],must_not:[{}],should:[{}]}}},cbEsAggComList=cbObj2Array(esFilter).map(function(e){return{meta:"es-agg",caption:e.name+" Agg",value:cbAceStringify({column:"<agg_column>",filter:e.body},'"')}});cbEsAggComList.push({meta:"es-agg",caption:"Not Equal Agg",value:cbAceStringify({column:"<agg_column>",filter:{bool:{must_not:esFilter.termFilter}}},'"')}),cbEsAggComList.push({meta:"es-agg",caption:"Inline Script Agg",value:cbAceStringify({column:"<agg_column>",script:{inline:"if(doc[\\'column_name'].value==\\'F\\') {1} else {0}"}},'"')});var cbEsExpAggCompleter={getCompletions:function(e,n,t,o,l){l(null,cbEsAggComList)}},cbEsExpFilterCompleter={getCompletions:function(e,n,t,o,l){var a=cbObj2Array(esFilter).map(function(e){return{meta:"es-filter",caption:e.name,value:cbAceStringify(e.body,null,null,!1)}});l(null,a)}},datasetEditorOptions=function(){var e=angular.copy(cbAcebaseOption);return e.onLoad=function(e){e.completers=[],e.completers.push(cbEsQueryCompleter)},e},schemaCustomOpt=function(e,n){var t=angular.copy(cbAcebaseOption),o={getCompletions:function(n,t,o,l,a){a(null,e.map(function(e){var n=e.column?e.column:e;return{caption:e.alias?e.alias:n,value:n,meta:"selects"}}))}};return t.onLoad=function(e){e.completers=[],e.completers.push(o),null!==n&&n.toLowerCase().indexOf("elasticsearch")>-1&&e.completers.push(cbEsSchemaORCompleter)},t},expEditorOptions=function(e,n){var t,o=angular.copy(cbAcebaseOption),l={getCompletions:function(n,t,o,l,a){a(null,e.map(function(e){var n=e.column?e.column:e;return{caption:e.alias?e.alias:n,value:n,meta:"selects"}}))}};return n&&(t={getCompletions:function(e,t,o,l,a){a(null,n.map(function(e){return{caption:e.name,value:e.name+"()",meta:"aggregate"}}))}}),o.onLoad=function(e){e.completers=[],e.completers.push(cbEsExpAggCompleter),e.completers.push(cbEsExpFilterCompleter),e.completers.push(l),e.completers.push(t)},o};